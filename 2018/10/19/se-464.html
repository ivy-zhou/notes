<!DOCTYPE html><html lang="en">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>SE 464 - Sentences</title>

<meta name="description" content="Professor Werner Dietl, Fall 2018Introsoftware architecture: set of principal design decisions about the system, blueprint for software construction and evol...">
<link rel="canonical" href="notes/2018/10/19/se-464.html"><link rel="alternate" type="application/rss+xml" title="Sentences" href="notes/feed.xml"><!-- start favicons snippet, use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="notes/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="notes/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="notes/assets/favicon-16x16.png"><link rel="manifest" href="notes/assets/site.webmanifest"><link rel="mask-icon" href="notes/assets/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="notes/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="notes/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicons snippet --><link rel="stylesheet" href="notes/assets/css/main.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" ><!-- start custom head snippets -->

<!-- end custom head snippets -->
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.isFormElement = function(node) {
    var tagName = node.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i;
      loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cbs[i]();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();
(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();
(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();
</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.6',
      sources: {
        font_awesome: 'https://use.fontawesome.com/releases/v5.0.13/css/all.css',
        jquery: 'https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        valine: 'https://unpkg.com/valine/dist/Valine.min.js',
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: 'notes/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script>
</head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main page__viewport has-aside cell cell--auto">

      <div class="page__main-inner"><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="24px" height="24px" viewBox="0 0 24 24">
<style type="text/css">
	.st0{fill:#515151;}
</style>
<path class="st0" d="M1.7,22.3c5.7-5.7,11.3-5.7,17,0c3.3-3.3,3.5-5.3,0.8-6c2.7,0.7,3.5-1.1,2.3-5.6s-3.3-5.2-6.3-2.1
	c3-3,2.3-5.2-2.1-6.3S7,1.8,7.7,4.6C7,1.8,5,2.1,1.7,5.3C7.3,11,7.3,16.7,1.7,22.3"/>
</svg>
<a title="A loosely organized collection of notes and thoughts
" href="notes/">Sentences</a></div><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></div><nav class="navigation">
        <ul><li class="navigation__item"><a href="notes/archive.html">Archive</a></li><li class="navigation__item"><a href="notes/about.html">About</a></li><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li></ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div>
</aside></div>

              <div class="col-main cell cell--auto"><!-- start custom main top snippet -->

<!-- end custom main top snippet -->
<article itemscope itemtype="http://schema.org/Article"><div class="article__header"><header><h1>SE 464</h1></header><span class="split-space">&nbsp;</span>
          <a class="edit-on-github"
            title="Edit on Github"
            href="https://github.com/ivy-zhou/notes/tree/master/_posts/2018-10-19-se-464/2018-10-19-se-464.md">
            <i class="far fa-edit"></i></a></div><meta itemprop="headline" content="SE 464"><div class="article__info clearfix"><ul class="left-col menu"><li>
              <a class="button button--secondary button--pill button--sm"
                href="notes/archive.html?tag=uwaterloo">uwaterloo</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="notes/archive.html?tag=notes">notes</a>
            </li></ul><ul class="right-col menu"><li><i class="far fa-calendar-alt"></i> <span>Oct 19, 2018</span>
            </li></ul></div><meta itemprop="author" content="Ivy Zhou"/><meta itemprop="datePublished" content="2018-10-19T00:00:00+00:00">
    <meta itemprop="keywords" content="uwaterloo,notes"><div class="js-article-content"><div class="layout--article"><!-- start custom article top snippet -->

<!-- end custom article top snippet -->
<div class="article__content" itemprop="articleBody"><blockquote>
  <p>Professor Werner Dietl, Fall 2018</p>
</blockquote>

<h2 id="intro">Intro</h2>

<p><strong>software architecture:</strong> set of principal design decisions about the system, blueprint for software construction and evolution. It has 3 aspects: structure/behaviour/interaction of system, communication, non-functional requirements.</p>

<p>Non-functional requirements define the behaviour of a system (e.g. system should be fast and secure). Functional requirements define what a system is supposed to do (e.g. system should book me Fedbus tickets).</p>

<p>We want <em>practical</em> ways to <em>guarantee</em> that software is correct. The different ways that we can do this fall on a spectrum.</p>

<p><img src="image-20181019184718747.png" alt="image-20181019184718747" /></p>

<p>In the top right corners we have specialized type systems like Android’s SPARTA (Static Program Analysis for Reliable Trusted Apps) which guarantee no leakage of private information.</p>

<p>Something with high practicality but low guarantees would be crowd-sourced verification.</p>

<p>Another approach is MUSE (Mining and Understanding Software Enclaves). This program mines specifications from a code base continuously, automates finding/repairing program errors, and synthesizes new programs from the existing codebase using mined specifications. It’s composed of open source software projects.</p>

<h2 id="architecture">Architecture</h2>

<p>We choose a design based on the following factors (among others):</p>

<ul>
  <li>fitness for purpose,</li>
  <li>cost of production (parts, labour, capital/tools)</li>
  <li>cost of operation</li>
  <li>fitness for future</li>
</ul>

<p>Steps of the design process:</p>

<ol>
  <li>Ideation</li>
  <li>Analysis: determine and apply criteria</li>
  <li>Selection of design</li>
  <li>Elaboration/Refinement</li>
  <li>Iteration</li>
</ol>

<p>Radical components are components that haven’t been invented yet. Radical configurations are designs that haven’t been tried yet. As designers, we want to take radical problems (problems solvable with radical configurations/designs) and solve them with existing/standard/normal solutions.</p>

<p>All of architecture involves design, but not all of design involves architecture (i.e. art).</p>

<p>The same system can have multiple architectures i.e. logical web architecture (class diagrams) vs. physical web architecture (server map) vs. dynamic web architecture (realtime map of requests sent/received).</p>

<p>Stakeholders in a system’s architecture include: architects, developers, testers, managers, customers, users, and vendors. These people define the goals of the system and then make principal architecture decisions that achieve those goals.</p>

<p><strong>prescriptive architecture:</strong> design decisions made prior to the system’s construction, as-intended design</p>

<p><strong>descriptive architecture:</strong> describes how the system has been built, as-implemented architecture</p>

<p><strong>architectural evolution:</strong> when a system needs to be changed. Ideally we would go back to modify a system’s prescriptive architecture (i.e. change the overall design of the system to fit). In practice, the descriptive architecture (the system) is directly modified. This happens because of: developer sloppiness, short deadlines, lack of documented prescriptive architecture, need/desire for code optimizations, inadequate techniques or tool support.</p>

<p><strong>architectural degradation:</strong> introduction of principal design decisions into a system that don’t violate the original prescriptive architecture</p>

<p><strong>architectural erosion:</strong> introduction of architectural design decisions into a system that violate the original prescriptive architecture</p>

<p><strong>architectural recovery:</strong> process of determining a system’s architecture from its implementation artificats e.g. source code, executable files, bytecode. Used to recover architecture from architectural degradation/erosion.</p>

<p>A software architecture should be a composition of multiple interacting elements. There are 3 types of elements: processing, data/state, interaction.</p>

<p><strong>components:</strong> software elements that encapsulate processing and data. They perform data hiding, have an interface, and has explicitly defined dependencies e.g. a software class. They provide application services.</p>

<p><strong>connectors:</strong> interaction effects and regulates interactions among components e.g. procedure call connectors, shared memory connectors, message passing connectors, streaming connectors, distribution connectors, wrapper/adapter connectors. They provide application specific independent interaction facilities.</p>

<p><strong>configuration:</strong> topology of components and connectors in a system’s architecture</p>

<p>The <em>deployment view</em> of an architecture is the description of how that architecture has been physically placed on hardware. We can assess it through its available memory, power consumption, and required network bandwidth.</p>

<p>Building software is hard because:</p>

<ul>
  <li>It’s a young field</li>
  <li>There are high user expectations</li>
  <li>Software relies on software relies on hardware</li>
  <li>Complexity increases non-linearly with program size</li>
  <li>Conformity, system state depends on its environment</li>
  <li>Changeability, software is too easily modified</li>
  <li>Intangibility, follows no laws</li>
</ul>

<p>Ways we can make it less hard:</p>

<ul>
  <li>High level languages</li>
  <li>Development tools and environments</li>
  <li>Component based reuse</li>
  <li>Development strategies
    <ul>
      <li>Incremental, iterative method</li>
      <li>Waterfall: requirements to design to implementation to verification to maintenance</li>
      <li>Evolutionary prototyping: build robust prototype and refine it so that users can have access to it before final system is created</li>
      <li>The spiral model, which examines the risks of a project and picks another development strategy that best fits the risk</li>
    </ul>
  </li>
  <li>Emphasis on designing software before we implement it</li>
</ul>

<h2 id="views-and-non-functional-properties">Views and Non-functional Properties</h2>

<p>Recall that architecture composes components and connectors. From a topological standpoint, we want to:</p>

<ul>
  <li>minimize coupling (information hide between components)</li>
  <li>maximize cohesion within each component (each component is one logical service)</li>
</ul>

<p><strong>abstraction:</strong> remove unnecessary detail. You can abstract away control (e.g. do-while loop) and you can abstract away data types e.g interfaces.</p>

<p><strong>decomposition:</strong> top-down abstraction where we break problem into independent components and we describe each component</p>

<p>Conway’s Law: The structure of a system reflects the structure of the organization that built it</p>

<p><strong>architectural representations:</strong> technical communciation about a system between stakeholders, has properties: ambiguity, accuracy, and precision</p>

<blockquote>
  <p>Reading assignment: <a href="https://www.cs.ubc.ca/~gregor/teaching/papers/4+1view-architecture.pdf">4 + 1 View Model</a></p>

  <p>A system has a logical view, a development view, a process view (runtime), and a physical view. Each is appropriate for some stakeholder and scenario.</p>
</blockquote>

<p><strong>architectural model:</strong> an artificat documenting some or all of the architectural design decisions about a system</p>

<p><strong>architecture visualization:</strong> way of depicting some or all of the architectural design decisions about a system to a stakeholder</p>

<p><strong>architecture view:</strong> subset of related architectural design decisions</p>

<p><strong>component diagram:</strong> captures components and static relationships between components</p>

<p><strong>sequence diagram:</strong> captures behaviour of system for a specific runtime scenario</p>

<p><strong>deployment diagram:</strong> mapping between components and physical devices</p>

<p><strong>statechart diagram:</strong> formal description of system behaviour through states, doesn’t map well to components</p>

<p>Classifications of non-functional properties:</p>

<p><img src="image-20181019202101175.png" alt="image-20181019202101175" /></p>

<p><strong>non-functional property (NFP):</strong> constraint on the way a system is implemented or delivers its functionality e.g. efficiency, scalability, evolvability, complexity, heterogenity, dependability</p>

<p>A system has to be designed for functional properties (FPs) to be correct and designed for NFPs to be usable. Each stakeholder has their own opinion on what NFPs matter most e.g. QA interested in testability more than sales, developers interested more about maintainability than customer.</p>

<p>Challenges to ensuring NFPs:</p>

<ul>
  <li>Some are only partially understood by other stakeholders</li>
  <li>They can be qualitative rather than quantitative</li>
  <li>They frequently depend on many variables</li>
  <li>Non-technical pressures e.g. time-to-market of functional features</li>
</ul>

<p>Design <em>guidelines</em> (not laws!) for ensuring NFPs:</p>

<ul>
  <li>
    <p>Efficiency: system’s ability to meet performance requirements</p>

    <ul>
      <li>Components
        <ul>
          <li>Keep them small</li>
          <li>Simple and compact interfaces</li>
          <li>Allow multiple interfaces to the same functionality</li>
          <li>Separate data from processing compoents</li>
          <li>Separate data from metadata</li>
        </ul>
      </li>
      <li>Connectors
        <ul>
          <li>Carefully select connectors</li>
          <li>Be careful of broadcast connectors</li>
          <li>Encourage async interaction</li>
          <li>Be wary of location/distribution transparency</li>
        </ul>
      </li>
      <li>Topology
        <ul>
          <li>Keep frequent collaborators close (e.g. in memory)</li>
          <li>Consider efficiency impact of selected style</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Complexity: the size of a system, its volume of constituent elements, their internal structure, and their interdependencies</p>

    <ul>
      <li>Components:
        <ul>
          <li>Separate concerns</li>
          <li>Isolate functionality from interaction</li>
          <li>Ensure cohesiveness</li>
          <li>Insulate processing from data format changes</li>
        </ul>
      </li>
      <li>Connectors
        <ul>
          <li>Isolate interaction from functionality</li>
          <li>Restrict interactions provided by each connector</li>
        </ul>
      </li>
      <li>Topology
        <ul>
          <li>Eliminate unnecessary dependencies</li>
          <li>Use hierarchical decomposition</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Scalability: capability of system to meet new size/scope requirements</p>

    <p>Heterogeneity: ability of system to be compose of or execute in disparate parts</p>

    <p>Portability: ability of system to execute on mulitple platforms while retaining FPs and NFPs of original</p>

    <ul>
      <li>Components
        <ul>
          <li>Keep components focused</li>
          <li>Simplify interfaces</li>
          <li>Avoid unnecessary heterogeneity</li>
          <li>Distribute data sources</li>
          <li>Replicate data</li>
        </ul>
      </li>
      <li>Connectors
        <ul>
          <li>Use explicit connectors</li>
          <li>Use simplest connectors</li>
        </ul>
      </li>
      <li>Topology
        <ul>
          <li>Avoid bottlenecks</li>
          <li>Place data close to consumer</li>
          <li>Location transparency</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Evolvability: ability to change to satisfy new requirements and environments</p>

    <ul>
      <li>Components
        <ul>
          <li>Same as for complexity</li>
          <li>Isolate modifications to reduce risks</li>
        </ul>
      </li>
      <li>Connectors
        <ul>
          <li>Clearly define responsibilities</li>
          <li>Make connectors flexible</li>
        </ul>
      </li>
      <li>Topology:
        <ul>
          <li>Avoid implicit connectors</li>
          <li>Encourage location transparency</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Dependability: ability of a system to respond to failures (from environment, components, connectors) to failures at runtime</p>

    <p>Survivability: ability to resist, recover and adapt to threats (i.e. prevent future threats)</p>

    <p>Safety: ability to avoid failures that will cause loss of life, injury, or loss of property</p>

    <ul>
      <li>Components
        <ul>
          <li>Control external component dependencies</li>
          <li>Support reflection</li>
          <li>Support exception handling</li>
        </ul>
      </li>
      <li>Connectors
        <ul>
          <li>Use explicit connectors</li>
          <li>Provide interaction guarantees</li>
        </ul>
      </li>
      <li>Topology
        <ul>
          <li>Avoid single points of failure</li>
          <li>Enable back ups</li>
          <li>Support system health monitoring</li>
          <li>Support dynamic adaptation</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="architectural-styles">Architectural Styles</h2>

<p>We can classify ways to design software in terms of the scope of that design and the amount of domain specific knowledge that that design uses.</p>

<p><img src="image-20181020134831362.png" alt="image-20181020134831362" /></p>

<blockquote>
  <p>Reading assignment: <a href="https://www.oreilly.com/ideas/contrasting-architecture-patterns-with-design-patterns">Design vs Architecture Patterns</a></p>

  <p>Archiecture design differs from design patterns int that:</p>

  <ul>
    <li>They talk about overall components rather than classes e.g. in layered architecture pattern, we talk about the presentation layer and the business layer rather than a Button class</li>
    <li>Design patterns only talk about one type of entity e.g. a Builder class, whereas architectural patterns can talk about many components e.g. in microkernel architecture, the core system component and the plugin component</li>
    <li>Architectural patterns have many variants and hybrids. For example, event driven architectures has a mediator variant (events passed through central mediator) and a broker variant (forwards requests).</li>
    <li>Architectural patterns operate at a higher level of abstraction, are scaffolding frameworks</li>
  </ul>
</blockquote>

<blockquote>
  <p>Reading assignment: <a href="https://dl.acm.org/citation.cfm?id=1629596">seL4: Formal verification of an OS kernel</a></p>
</blockquote>

<h3 id="architectural-patterns">Architectural Patterns</h3>

<p><strong>architectural pattern:</strong> set of architectrual design decisions that are applicable to a recurring design problem and parameterized to account for different contexts in which that problem appears</p>

<h4 id="three-tiered-pattern">Three Tiered Pattern</h4>

<p>Front tier: contains user interface functionality</p>

<p>Middle tier: contains applications major functionality</p>

<p>Back tier: contains application’s data access and storage functionality</p>

<h4 id="mvc">MVC</h4>

<p>3 components</p>

<ul>
  <li>Model for core functionality and data</li>
  <li>Views for displaying information to user</li>
  <li>Controllers for handling user input</li>
</ul>

<p><img src="image-20181020140546305.png" alt="image-20181020140546305" /></p>

<h4 id="sense-compute-control">Sense-Compute-Control</h4>

<p><img src="image-20181020140618459.png" alt="image-20181020140618459" /></p>

<h3 id="architectural-styles-1">Architectural Styles</h3>

<p><strong>architectural styles:</strong> collection of architectural design decisions for a system that constrain further decisions about that system. It can be implemented with some subset of architectural patterns, and it will have its own design vocabulary in terms of custom components and connectors. We use them because:</p>

<ul>
  <li>Design/code reuse</li>
  <li>Understandability of system through standardization (known invariants)</li>
  <li>Interoperability</li>
  <li>Style specific analyses are already known (advantages/disadvantages)</li>
  <li>Ways to visualize are already known</li>
</ul>

<p>Properties of good architecture:</p>

<ul>
  <li>Results in a consistent set of principled decisions</li>
  <li>Resilient to change</li>
  <li>Source of guidance through product lifetime</li>
  <li>Reuses established engineering knowledge</li>
</ul>

<p>We rarely use only one unmodified (pure) architectural style in a system.</p>

<p>Taxonomy of architectural styles:</p>

<p><img src="image-20181020142610353.png" alt="image-20181020142610353" /></p>

<h4 id="layered-style">Layered Style</h4>

<p>Has a hierarchical system organization, each layer acts as a server for layers above and a client for layers below. Connectors are thought of as protocols of layer interaction.</p>

<p>For instance, in a <em>virtual machine</em>, client software runs on an opaque layer of virtualized hardware.</p>

<p><img src="image-20181020144000399.png" alt="image-20181020144000399" /></p>

<p>Advantages:</p>

<ul>
  <li>Abstraction increases up the layers</li>
  <li>Evolvability</li>
  <li>Changes in a layer affect at most the adjacent two layers, so aids reuse</li>
  <li>Low coupling since a layer only interacts with layers above and below it</li>
  <li>Standardized layer interfaces</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>Not universally applicable</li>
  <li>Performance (may force high level layers to be coupled with lower ones)</li>
</ul>

<h5 id="client-server-style">Client-Server Style</h5>

<p>Layed architecture with only 2 layers, a client layer and a server layer. Servers don’t know the number of identity of clients, but clients know their server’s identity. Connectors are remote procedure calls on the network according to some protocol.</p>

<p><img src="image-20181020144021616.png" alt="image-20181020144021616" /></p>

<p>Advantages:</p>

<ul>
  <li>Abstraction between servers and clients (servers don’t care about the state of the client)</li>
  <li>Redundancy in that new connections can easily be set up</li>
  <li>One change to a server can affect all of its clients (evolvability)</li>
  <li>Standardized protocol between servers and clients</li>
  <li>Ease in scaling</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>Performance (server can become bottleneck)</li>
  <li>Easy point of attack at server</li>
</ul>

<h4 id="data-flow-styles">Data Flow Styles</h4>

<h5 id="batch-sequential">Batch Sequential</h5>

<p>Separate programs executed in order, data is passed as an aggregate from one to the next. THe connectors between programs is the physical process of loading the next program in (no concurrency, non-interactive). These systems are still used in transaction processing.</p>

<h5 id="pipe-and-filter-style">Pipe and Filter Style</h5>

<p>Components are filters which do some transformation on their input stream and produce an output stream. Connectors are the pipes which allow the streams to travel from filter to filter. Each filter has no knowledge of other filters or their state. Examples include the unix shell (ls to grep), distributed systems, signal processing, compilers, and parallel programming.</p>

<p>3 variations on pipe and filter: bounded pipe (only allow a certain amount of data), pipelines (only linear), and typed pipes (only allow data of a certain type).</p>

<p><img src="image-20181020194145456.png" alt="image-20181020194145456" /></p>

<p>We might think of the pipe and filter style as a layered architecture turned sideways.</p>

<p>Advantages:</p>

<ul>
  <li>Simple composition</li>
  <li>Reuse</li>
  <li>Prototyping</li>
  <li>Easy growth and evolution (evaluating for bottlenecks is easy)</li>
  <li>Filters can be easily re-implemented without affecting the rest of the system</li>
  <li>Concurrency and parallelism</li>
</ul>

<p>Disadvantages</p>

<ul>
  <li>Poor performance: each filter has to parse data, sharing global data is difficult</li>
  <li>Not appropriate for interaction</li>
  <li>Low fault tolerance threshold (e.g. what happens when a filter crashes)</li>
  <li>Data transformation to stream to accomodate filters</li>
  <li>Increases complexity and computation</li>
</ul>

<h4 id="shared-memory">Shared Memory</h4>

<h5 id="blackboard">Blackboard</h5>

<p>A central data structure (the blackboard) holds all state and controls the whole system. Components then operate on the blackboard. Connections are either active, as in incoming streams of transactions on a database, or passive as in changes on a blackboard trigger other processes. Examples of this include AI systems, integrated software environments, and compiler architecture (imagine stack).</p>

<p>Advantages:</p>

<ul>
  <li>Efficient when dealing with large amounts of Data</li>
  <li>Clients are loosely coupled</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>Data model is static, bounded by defined schema, resistant to change since many clients depend on it</li>
  <li>Difficult to distribute</li>
</ul>

<p><img src="image-20181020195020906.png" alt="image-20181020195020906" /></p>

<h5 id="rule-based-style">Rule-based style</h5>

<p>An inference engine parses user input and determines whethere whether it’s a fact/rule or a query. If it’s fact/rule, it adds it into its knowledge base. If it’s a query, it looks for relevant rules to produce an fact for the query. This approach has many applications in artificial intelligence, since the rules approximate how humans think.</p>

<p>Thus, we can easily change the system by changing its rules. When there’s a large number of rules, they may conflict in the fact that they produce based on the facts/query given.</p>

<p>Advantages:</p>

<ul>
  <li>Can easily build very flexible evolvable systems by changing rules</li>
  <li>Systems can be very lightweight and scalable</li>
  <li>We can use formal logic to verify coverage of rules</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>It’s hard to come up with rules, we may run into conflicts</li>
</ul>

<h4 id="interpreter">Interpreter</h4>

<h5 id="interpreter-style">Interpreter style</h5>

<p>Dynamically add to the set of commands possible in the system, good for end user programmability. Examples of this are LISP and Scheme. Suitable for applications in which the most appropriate language or machine for executing the solution is not directly available. Components are an interpretation engine, memory, and state. Connectors are procedure calls and directt memory access. Examples include programming language compilers and scripting languages.</p>

<p><img src="image-20181020201008168.png" alt="image-20181020201008168" /></p>

<p>Advantages:</p>

<ul>
  <li>High evolvability due to ability to add new capabailities dynamically</li>
  <li>Simulation of non-implemented parts</li>
  <li>Portability</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>Can be slow due to computational complexity</li>
</ul>

<h4 id="implicit-invocation">Implicit Invocation</h4>

<p>Method calls are explicit invocations. Triggering a registered listener’s handler with an event is an implicit invocation. Event broadcasters don’t know anything about the event consumers, the effects of the events, or the ordering of the events.</p>

<h5 id="publish-subscribe-style">Publish-subscribe style</h5>

<p>Components register for events, which are then published by different sources or by a centralized system e.g. news, fire alarms, MVC, IDEs, database systems, user interfaces</p>

<p><img src="image-20181020201440955.png" alt="image-20181020201440955" /></p>

<h5 id="event-based-style">Event based style</h5>

<p><img src="image-20181020201505529.png" alt="image-20181020201505529" /></p>

<p>Advantages:</p>

<ul>
  <li>Scalable, new listeners can just register themselves</li>
  <li>Minimal dependency and loose coupling, components can be added/removed, components don’t directly interact with each other</li>
  <li>Highly reusable, can easily reimplement without chaning interface</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>Loss of execution control</li>
  <li>Data exchange has to be in terms of events, which has a hit on performance</li>
  <li>Hard to debug, as contracts between components are not formalized and any event can set off a chain of side effects</li>
</ul>

<h4 id="peer-to-peer-style">Peer-to-Peer Style</h4>

<p>State and behaviour are distributed among peers which can act as either clients or servers. Each peer is a component with their own state. Connectors consist of network protocols and data elements are network messages. Skype used to have this sort of architecture.</p>

<p>Advantages:</p>

<ul>
  <li>Hard to attack, since there’s no central server</li>
  <li>Arguably more secure/performant communication, again since no central server is involved</li>
</ul>

<p>Disadvantages:</p>

<ul>
  <li>Client machines are often much less reliable than a central server</li>
</ul>

<p><strong>Common Object Request Broker Arhcitecture (CORBA):</strong> allows for communication between systems deployed on different OS’s, programming languages, and hardware</p>

<p>CORBA places a different <strong>distributed object</strong> on each platform they’re trying to support. These objects can share data and invoke methods on other objects through a well-defined API. In CORBA, the components are the distributed objects, the connectors are the RPC invocations, and the data elements are the arguments to methods, return values, and exceptions.</p>

<p>If architectures use differing architectural styles, they’ll differ greatly. If they have the same architectural, style, they can still be different variations.</p>

<h4 id="design-recovery">Design Recovery</h4>

<p>To do design recovery, we can either do syntactic clustering or semantic clustering.</p>

<h5 id="syntactic-clustering">Syntactic Clustering</h5>

<p>Static code analysis done without running the program. We can identify coupling and cohesion from descriptions of components, but we may miss some purely dynamic relationships e.g. exception handling.</p>

<h5 id="semantic-clustering">Semantic Clustering</h5>

<p>Use domain knowledge about the application and behavioural similarity of its entities to infer their meaning. We can verify that these inferred meanings are correct through executing the system on a representative set of inputs. This is tough to automate.</p>

<h5 id="greenfield-design">Greenfield Design</h5>

<p>Sometimes, we just start over from scratch to find out what the architecture of the system should be without looking that much at the existing source code. To do this, we can look for analogies for the system in real life, brainstorm, search existing literature, create morphological charts (list all necessary functions and possible implementations) etc.</p>

<h2 id="architectural-styles-2">Architectural Styles 2</h2>

<blockquote>
  <p>Reading assignment: <a href="http://aosabook.org/en/eclipse.html">Eclipse architecture</a></p>
</blockquote>

<blockquote>
  <p>Reading assignment: <a href="http://aosabook.org/en/llvm.html">LLVM architecture</a></p>

  <p>Compiler architecture is generally organized as 3 phase design: a frontend for AST building, an optimizer, and a backend for machine code generation. These 3 sections are rarely separated cleanly due to implementation e.g. in GCC, the backend walks the frontend AST for debugging info, the frontend generate backend data strcutures, and global data structures are used throughout.</p>

  <p>LLVM uses an intermediate representation (IR) which is a step above machine code. Front end produces IR, the optimizer optimizes IR ot better IR through multiple passes, and the backend converts IR to machine code in multiple passes. We can configure which passes are done for a specific compilation case e.g. not many registers available.</p>

  <p>The backend uses target description <code class="language-plaintext highlighter-rouge">.td</code> files to describe specific properties about the target being compiled to e.g. a list of all 16 32-bit registers available. We can augment this information with C++ code specific to the architecture e.g. for handling x87 floating point stack.</p>

  <p>LLVM IR can be (de)serialized into a binary format called LLVM bitcode. Serializing to bitcode at an intermediate step rather than creating object code right away allows us to delay code generation to link time or even install time to get better optimizations.</p>

  <p>LLVM IR is much easier to unit test because you can load LLVM IR specific to the piece of the compiler that is broken, rather than create a <code class="language-plaintext highlighter-rouge">.c</code> file which runs through the whole compiler in an effort to test one crashing optimizer. To find which optimizer is offending, you can use the LLVM BugPoint tool which reduces a list of crashing optimizers and input to a minimum test case.</p>
</blockquote>

<h6 id="example-exam-question">Example Exam Question</h6>

<p>Consider a development environment capable of integrating a set of tools (e.g., compiler, editor, debugger, etc.) produced by different vendors. What is the architectural style most appropraite for the system? Give a sketch of the system and explain the interaction between parts of the architecture. Give one advantage and one disadvantage of the given choice.</p>

<p>The architectural style most suitable would be the layered virtual machine architectural style. The editor and the debugger would both be layers on top of the compiler layer, and would use the compiler as a blackbox on top of which they can call functions. One advantage of this is that it is a very decoupled design, which is advantageous since there are multiple vendors. One disadvantage may be the performance, which can be impacted as we get higher and higher level tools.</p>

<h2 id="architectural-modelling">Architectural modelling</h2>

<p><strong>architectural model:</strong> artifact that captures the documented design decisions in a system’s architecture</p>

<p><strong>architectural modelling notation:</strong> language/means used by an architectural model</p>

<p>Stakeholders in the system have to determine what should be modelled, at what level of detail, and with how much rigor. They should do a cost-benefit analysis on what to model.</p>

<p>Things we can model:</p>

<ul>
  <li>Basic architectural elements
    <ul>
      <li>Components</li>
      <li>Connectors</li>
      <li>Interfaces</li>
      <li>Configurations</li>
      <li>Rationale (reason behind decisions)</li>
    </ul>
  </li>
  <li>Elements of architectural style
    <ul>
      <li>Specific basic architectural elements relevant to the style</li>
      <li>Component, connector, interface types</li>
      <li>Constraints on interactions, behavioural constraints, concurrency constraints</li>
    </ul>
  </li>
  <li>Static and Dynamic aspects
    <ul>
      <li>Static aspects of a system don’t change as the system runs e.g. logical topologies, deployment map</li>
      <li>Dynamic aspects of the system change as the system runs e.g. state of individual componetns or connectors, state of a data flow through the system</li>
    </ul>
  </li>
  <li>Functional and non-functional aspects of a system</li>
</ul>

<p>We should consider a model’s ambiguity, accuracy, and precision.</p>

<p><strong>view:</strong> subset of a architectural model according to a <em>viewpoint</em>, which is a set of criteria that restrict the design decisions captured in the view e.g. logical, physical, deployment, concurrency, behavioural</p>

<p>We use several views from different viewpoints to capture a single model, because using one large view would be infeasible and impractical.</p>

<p>Views can contain overlapping and related design decisions. If decision decisions presented by 1 view conflict with those of another view, those two views are inconsistent. Otherwise, they’re consistent.</p>

<p>Types of inconsistencies:</p>

<ul>
  <li>direct inconsistencies e.g. the system runs on 2 hosts vs. the system runs on 3 hosts</li>
  <li>refinement inconsistencies, meaning the high level and the low level views of the same parts of a system conflict</li>
  <li>static (topology) or dynamic (behaviour) aspects inconsistencies, e.g. different description of system behaviour in 2 different views, different topologies described in 2 different views</li>
  <li>functional or non-functional inconsistencies</li>
</ul>

<p>Sometimes, inconsistencies are OK, but most of the the time, it means there’s some problem with your system.</p>

<p>To evaluate a modelling approach, consider:</p>

<ul>
  <li>Scope and purpose, what is modelled (or not modelled) by the approach?</li>
  <li>Basic elements of the model</li>
  <li>Style, how well the model fits with the underlying architectural style</li>
  <li>Static/dynamic aspects</li>
  <li>Dynamic modelling, how the model change as the system changes</li>
  <li>Non-functional aspects</li>
  <li>Ambiguity</li>
  <li>Accuracy</li>
  <li>Precision</li>
  <li>Viewpoints</li>
  <li>Viewpoint consistency</li>
</ul>

<p>Approaches to modelling:</p>

<ul>
  <li>Generic approaches e.g. natural language, powerpoint, UML</li>
  <li>Early architecture description languages e.g. Darwin, Rapide, Wright</li>
  <li>Domain/style specific languages e.g. Koala, Weave, AADL</li>
  <li>Extensible architecture description languages e.g. Acme, ADML, xADL</li>
</ul>

<p><strong>Unified Modelling Language (UML):</strong> widespread notations for modelling static and dynamic aspects of systems</p>

<p>Static aspect views in UML:</p>

<ul>
  <li>
    <p>Component diagrams</p>

    <p><img src="https://agilemodeling.com/images/models/componentDiagramUML2.jpg" alt="img" /></p>
  </li>
  <li>
    <p>Deployment diagrams</p>

    <p><img src="https://agilemodeling.com/images/models/deploymentDiagram.jpg" alt="img" /></p>
  </li>
  <li>
    <p>Class diagrams</p>

    <p><img src="https://agilemodeling.com/images/models/classDiagramInheritance.jpg" alt="img" /></p>
  </li>
</ul>

<p>Dynamic aspect views in UML:</p>

<ul>
  <li>
    <p>Sequence diagrams</p>

    <p><img src="https://agilemodeling.com/images/models/sequenceDiagramEnrollInSeminar.jpg" alt="img" /></p>
  </li>
  <li>
    <p>Use case diagrams</p>

    <p><img src="https://agilemodeling.com/images/models/useCaseDiagram.jpg" alt="img" /></p>
  </li>
  <li>
    <p>State machine diagrams</p>

    <p><img src="https://agilemodeling.com/images/models/stateMachineSeminarRegistration.jpg" alt="img" /></p>
  </li>
</ul>

<p>Advangtages of UML:</p>

<ul>
  <li>Support for many viewpoints relevant to software engineering</li>
  <li>Ubiquity improves comprehensibility, extensive documentation and tool support</li>
</ul>

<p>Disadvantages of UML:</p>

<ul>
  <li>Very ambiguous if not enough detail is given</li>
  <li>Difficult to assess consistency between views</li>
  <li>Difficult to capture new concepts or views</li>
</ul>

<h2 id="security-and-chrome">Security and Chrome</h2>

<p><strong>security:</strong> maintaining integrity (only authorized modifications), availability (accessible by authorized parties), and confidentiality (prevent access/knowledge from unauthorized parties) of system resources (hardware, software, firmware, data, communications etc.)</p>

<p>Design principles for security:</p>

<ul>
  <li>Least privilege: give each component only the privileges it requires</li>
  <li>Fail-safe defaults: deny access if explicit permission is absent</li>
  <li>Economy of mechanism: adopt simple security mechanisms</li>
  <li>Complete mediation: ensure every access is permitted</li>
  <li>Open design: do not rely on secrecy for security</li>
  <li>Separation of privilege: introduce multiple parties with differing privileges</li>
  <li>Least common mechanism: limit critical resource sharing to only a few mechanisms</li>
  <li>Psychological acceptability: make security mechanisms usable</li>
  <li>Defense in depth: have multiple layers of countermeasures</li>
</ul>

<h4 id="architectural-access-control-models">Architectural Access Control Models</h4>

<p><strong>discretionary access control:</strong> allow access to a resource based on the resource, the identity of the requestor, and whether the requestor has permission</p>

<p><img src="image-20181020234116212.png" alt="image-20181020234116212" /></p>

<p><strong>mandatory access control:</strong> define policies for resource accesss, i.e. users have classification hierarchy which correspond to resource classification hierarchy</p>

<p><img src="image-20181020234159905.png" alt="image-20181020234159905" /></p>

<p>Types of attacks</p>

<ul>
  <li>Impersonation of an authorized user</li>
  <li>Fradulent actions e.g. seller does not ship items bought</li>
  <li>Misrepresentation, delegitimize an authorized user</li>
  <li>Collusion, delegitimize an authorized user as a part of group</li>
  <li>Addition of users who have no information on other users in the system, where existing users on the system also don’t know about them</li>
</ul>

<p><strong>trust:</strong> the probability that an agent A asseses that another agent B will perform a particular action before A can monitor that action and in a context where it affects the actions of A i.e. A trusts B to do X in matters Y</p>

<p><strong>reputation:</strong> expectation about entity’s future behaviour based on its past behaviour</p>

<blockquote>
  <p>Reading assignment: <a href="https://queue.acm.org/detail.cfm?id=1556050">Browser security in Chrome</a></p>
</blockquote>

<blockquote>
  <p>Reading assignment: <a href="http://seclab.stanford.edu/websec/chromium/chromium-security-architecture.pdf">Security architecture of the Chromium Browser</a></p>
</blockquote>

<p>Chrome deals accesses insecure online content that can compromise:</p>

<ul>
  <li>confidentiality: leak user data</li>
  <li>integrity: read/write arbitrary data on disk</li>
  <li>availability: crash Chrome application or OS</li>
</ul>

<p>Chrome relies on least privilege, separation of privilege, and defence in depth. They sandbox to reduce severity of vulnerabilities, auto-update to reduce window of vulnerability, and warn about malicious sites before accessing them to reduce frequency of exposure to attacks.</p>

<p>Chrome architecture:</p>

<p><img src="image-20181020235804027.png" alt="image-20181020235804027" /></p>

<h2 id="design-introduction">Design Introduction</h2>

<p>Analysis models an existing system to deal with its functional challenges, while design creates a model to implement a new system to deal with its implementation challenges. The design of a system maps responsibilities to objects.</p>

<p>Design process loop:</p>

<ol>
  <li>Build</li>
  <li>Measure</li>
  <li>Learn</li>
</ol>

<p>We want to reuse designs in order to use previous experience and promote: abstraction, flexibility, modularity, and elegance.</p>

<p>We have to consider dynamic behaviour as well static relationships from examining just the code. As we increase abstraction, we have less control over the behaviour of the system.</p>

<h4 id="design-principles">Design Principles</h4>

<p>Don’t be STUPID, be SOLID.</p>

<p>STUPID:</p>

<ul>
  <li>Singleton</li>
  <li>Tight coupling</li>
  <li>Untestable</li>
  <li>Premature Optimization</li>
  <li>Indescriptive naming</li>
  <li>Duplicates</li>
</ul>

<p>SOLID</p>

<ul>
  <li>Single reponsibility prinicple</li>
  <li>Open/closed principle: classes should be open for extension but closed to modification</li>
  <li>Liskov Substitution Principle: subtypes should behave as their parent types, meaning 2 different subtypes should be interchangeable when used as their common supertype</li>
  <li>Interface Segregation: only place key methods in interfaces</li>
  <li>Dependency Inversion Principle: higher level methods should not depend on lower level modules</li>
</ul>

<p>Lower level principles:</p>

<ul>
  <li>Encapsulate what varies</li>
  <li>Program to abstractions not implementations</li>
  <li>Favour composition over inheirtance (enables runtime bheaviour changes and makes code easier to evolve in the future)</li>
  <li>Strive for loose coupling</li>
</ul>

<p>Quality attributes:</p>

<ul>
  <li>
    <p>Simplicity: Don’t Repeat Yourself (DRY), Keep it Simple, Stupid (KISS)</p>
  </li>
  <li>
    <p>Coupling, types of coupling on a scale</p>

    <p><img src="image-20181021010312115.png" alt="image-20181021010312115" /></p>
  </li>
  <li>
    <p>Cohesion, types of cohesion on a scale</p>

    <p><img src="image-20181021010332724.png" alt="image-20181021010332724" /></p>
  </li>
</ul>

<p>There is incoherency in an operation if it has too many “and” clauses (temporal cohesion, logical cohesion), and if it has too many “if…then…else” clauses (control coupling, coincidental cohesion, logical cohesion).</p>

<p><strong>Cognitive dimensions:</strong></p>

<ul>
  <li>premature commitment: decision made with insufficient data that constrains future choices</li>
  <li>hidden dependencies</li>
  <li>secondary notation: non-obvious relationships may be meaningful or provide context</li>
  <li>viscosity: reistance to change</li>
</ul>

<p>We want design patterns for the same reasons as we wanted architectural styles:</p>

<ul>
  <li>Ease communication with a shared vocabulary</li>
  <li>Leverage existing design knowledge</li>
  <li>Enhance flexibility for future change</li>
  <li>Increase reusability of developed code</li>
</ul>

<p><strong>design patterns:</strong> common solutions to recurring design problems (will have tradeoffs). They describe a class/object with well defined dependencies, structures, interactions, and convensions. They’re language independent and can be considered micro-architectures.</p>

<h2 id="design-patterns">Design Patterns</h2>

<h4 id="creational-patterns">Creational Patterns</h4>

<p>Ways to encapsulate construction logic for and defer class instantiation until runtime</p>

<h5 id="singleton-pattern">Singleton Pattern</h5>

<p><img src="image-20181021135235885.png" alt="image-20181021135235885" /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Singleton</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">Singleton</span> <span class="n">instance</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nf">Singleton</span><span class="o">()</span> <span class="o">{}</span>
	<span class="kd">static</span> <span class="nc">Singleton</span> <span class="nf">create</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
			<span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Singleton</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h5 id="factory-pattern">Factory Pattern</h5>

<p><img src="image-20181021141906788.png" alt="image-20181021141906788" /></p>

<h5 id="abstract-factory-pattern">Abstract Factory Pattern</h5>

<p><img src="image-20181021141932380.png" alt="image-20181021141932380" /></p>

<h5 id="builder-pattern">Builder Pattern</h5>

<p><img src="image-20181021142014492.png" alt="image-20181021142014492" /></p>

<p><img src="image-20181021142029413.png" alt="image-20181021142029413" /></p>

<h5 id="prototype-pattern">Prototype Pattern</h5>

<p><img src="image-20181021142105390.png" alt="image-20181021142105390" /></p>

<h4 id="structural-patterns">Structural patterns</h4>

<p>Ways to make the relationships between entities more flexible</p>

<h5 id="class-adpater-pattern">Class Adpater Pattern</h5>

<p><img src="image-20181021155945953.png" alt="image-20181021155945953" /></p>

<h5 id="object-adapter-pattern">Object Adapter Pattern</h5>

<p><img src="image-20181021160219881.png" alt="image-20181021160219881" /></p>

<h5 id="bridge-pattern">Bridge Pattern</h5>

<p><img src="image-20181021160405037.png" alt="image-20181021160405037" /></p>

<h5 id="decorator-pattern">Decorator Pattern</h5>

<p><img src="image-20181021160437010.png" alt="image-20181021160437010" /></p>

<h5 id="facade-pattern">Facade Pattern</h5>

<p><img src="image-20181021160500061.png" alt="image-20181021160500061" /></p>

<h5 id="proxy-pattern">Proxy Pattern</h5>

<p><img src="image-20181021160526693.png" alt="image-20181021160526693" /></p>

<h5 id="composite-pattern">Composite Pattern</h5>

<p><img src="image-20181021160556458.png" alt="image-20181021160556458" /></p>

<h5 id="flyweight-design-pattern">Flyweight Design Pattern</h5>

<p>If you have a lot of objects with the same unchanging internal state, you can create a Flyweight class encapsulating that state which all the objects can then share. You can also create a Factory that dispenses a particular Flyweight you need for an object. This saves on memory.</p>

<p><img src="image-20181021161823995.png" alt="image-20181021161823995" /></p>

<h2 id="design-patterns-2">Design Patterns 2</h2>

<h4 id="behavioural-patterns">Behavioural Patterns</h4>

<p>Identify common communication patterns between objects and make them more flexible</p>

<h5 id="visitor-pattern">Visitor Pattern</h5>

<p>Because Elements visited can be polymorphic (i.e. we have to call different visit methods on them), we do a double dispatch, meaning we make the accept method on each element call the correct visit implementation on the Visitor object it is passed.</p>

<p><img src="image-20181021163055658.png" alt="image-20181021163055658" /></p>

<h5 id="observer-pattern">Observer Pattern</h5>

<p><img src="image-20181021163946547.png" alt="image-20181021163946547" /></p>

<h5 id="interpreter-pattern">Interpreter pattern</h5>

<p>Implement a specialized computer language to rapidly solve a specific set of problems</p>
</div><section class="article__sharing d-print-none"></section><div class="d-print-none"><footer class="article__footer"><meta itemprop="dateModified" content="2018-10-19T00:00:00+00:00"><!-- start custom article footer snippet -->

<!-- end custom article footer snippet -->
<div class="article__subscribe"><div class="subscribe"><i class="fas fa-rss"></i> <a type="application/rss+xml" href="notes/feed.xml">Subscribe</a></div>
</div><div class="article__license"><div class="license">
    <p>This work is licensed under a <a itemprop="license" rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">Attribution-NonCommercial 4.0 International</a> license.
      <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">
        <img alt="Attribution-NonCommercial 4.0 International" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" />
      </a>
    </p>
  </div></div></footer>
<div class="article__section-navigator clearfix"><div class="previous"><span>PREVIOUS</span><a href="notes/2018/02/15/se-350-textbook-notes.html">SE 350 Textbook Notes</a></div><div class="next"><span>NEXT</span><a href="notes/2018/11/19/se-464-architecture-assignment.html">SE 464 Architecture Assignment - LLVM</a></div></div></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();
</script>
</div><section class="page__comments d-print-none"></section></article><!-- start custom main bottom snippet -->

<!-- end custom main bottom snippet -->
</div>
            </div></div></div><div class="page__footer d-print-none">
<footer class="footer py-4 js-page-footer">
  <div class="main"><div itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ivy Zhou"><meta itemprop="url" content="notes/"><meta itemprop="description" content="an uneasy soul"><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><li title="Follow me on Medium.">
        <a class="button button--circle medium-button" itemprop="sameAs" href="https://medium.com/ivyzhou" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M834.7 279.8l61.3-58.9V208H683.7L532.4 586.4 360.3 208H137.7v12.9l71.6 86.6c7 6.4 10.6 15.8 9.7 25.2V673c2.2 12.3-1.7 24.8-10.3 33.7L128 805v12.7h228.6v-12.9l-80.6-98a39.99 39.99 0 0 1-11.1-33.7V378.7l200.7 439.2h23.3l172.6-439.2v349.9c0 9.2 0 11.1-6 17.2l-62.1 60.3V819h301.2v-12.9l-59.9-58.9c-5.2-4-7.9-10.7-6.8-17.2V297a18.1 18.1 0 0 1 6.8-17.2z"></path>
</svg>
</div>
        </a>
      </li><li title="Follow me on Linkedin.">
        <a class="button button--circle linkedin-button" itemprop="sameAs" href="https://www.linkedin.com/in/zhouivy" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M260.096 155.648c0 27.307008-9.899008 50.516992-29.696 69.632-19.796992 19.115008-45.396992 28.672-76.8 28.672-30.036992 0-54.612992-9.556992-73.728-28.672-19.115008-19.115008-28.672-42.324992-28.672-69.632 0-28.672 9.556992-52.224 28.672-70.656 19.115008-18.432 44.372992-27.648 75.776-27.648 31.403008 0 56.32 9.216 74.752 27.648 18.432 18.432 28.331008 41.984 29.696 70.656 0 0 0 0 0 0m-202.752 808.96c0 0 0-632.832 0-632.832 0 0 196.608 0 196.608 0 0 0 0 632.832 0 632.832 0 0-196.608 0-196.608 0 0 0 0 0 0 0m313.344-430.08c0-58.708992-1.364992-126.292992-4.096-202.752 0 0 169.984 0 169.984 0 0 0 10.24 88.064 10.24 88.064 0 0 4.096 0 4.096 0 40.96-68.267008 105.812992-102.4 194.56-102.4 68.267008 0 123.220992 22.868992 164.864 68.608 41.643008 45.739008 62.464 113.664 62.464 203.776 0 0 0 374.784 0 374.784 0 0-196.608 0-196.608 0 0 0 0-350.208 0-350.208 0-91.476992-33.451008-137.216-100.352-137.216-47.787008 0-81.236992 24.576-100.352 73.728-4.096 8.192-6.144 24.576-6.144 49.152 0 0 0 364.544 0 364.544 0 0-198.656 0-198.656 0 0 0 0-430.08 0-430.08 0 0 0 0 0 0" />
</svg>
</div>
        </a>
      </li><li title="Follow me on Github.">
        <a class="button button--circle github-button" itemprop="sameAs" href="https://github.com/ivy-zhou" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path class="svgpath" data-index="path_0" fill="#272636" d="M0 525.2c0 223.6 143.3 413.7 343 483.5 26.9 6.8 22.8-12.4 22.8-25.4l0-88.7c-155.3 18.2-161.5-84.6-172-101.7-21.1-36-70.8-45.2-56-62.3 35.4-18.2 71.4 4.6 113.1 66.3 30.2 44.7 89.1 37.2 119 29.7 6.5-26.9 20.5-50.9 39.7-69.6C248.8 728.2 181.7 630 181.7 513.2c0-56.6 18.7-108.7 55.3-150.7-23.3-69.3 2.2-128.5 5.6-137.3 66.5-6 135.5 47.6 140.9 51.8 37.8-10.2 80.9-15.6 129.1-15.6 48.5 0 91.8 5.6 129.8 15.9 12.9-9.8 77-55.8 138.8-50.2 3.3 8.8 28.2 66.7 6.3 135 37.1 42.1 56 94.6 56 151.4 0 117-67.5 215.3-228.8 243.7 26.9 26.6 43.6 63.4 43.6 104.2l0 128.8c0.9 10.3 0 20.5 17.2 20.5C878.1 942.4 1024 750.9 1024 525.3c0-282.9-229.3-512-512-512C229.1 13.2 0 242.3 0 525.2L0 525.2z" />
</svg>
</div>
        </a>
      </li></ul>
</div>
</div>
    </div><div class="site-info mt-2">
      <div>© Sentences 2020,
        Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> & <a
        title="TeXt is a super customizable Jekyll theme." href="https://github.com/kitian616/jekyll-TeXt-theme">TeXt Theme</a>.
      </div>
    </div>
  </div>
</footer>
</div></div>
    </div><script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $body = $('body'), $window = $(window);
    var $pageRoot = $('.js-page-root'), $pageMain = $('.js-page-main');
    var activeCount = 0;
    function modal(options) {
      var $root = this, visible, onChange, hideWhenWindowScroll = false;
      var scrollTop;
      function setOptions(options) {
        var _options = options || {};
        visible = _options.initialVisible === undefined ? false : show;
        onChange = _options.onChange;
        hideWhenWindowScroll = _options.hideWhenWindowScroll;
      }
      function init() {
        setState(visible);
      }
      function setState(isShow) {
        if (isShow === visible) {
          return;
        }
        visible = isShow;
        if (visible) {
          activeCount++;
          scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
          $root.addClass('modal--show');
          $pageMain.scrollTop(scrollTop);
          activeCount === 1 && ($pageRoot.addClass('show-modal'), $body.addClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.on('scroll', hide);
          $window.on('keyup', handleKeyup);
        } else {
          activeCount > 0 && activeCount--;
          $root.removeClass('modal--show');
          $window.scrollTop(scrollTop);
          activeCount === 0 && ($pageRoot.removeClass('show-modal'), $body.removeClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.off('scroll', hide);
          $window.off('keyup', handleKeyup);
        }
        onChange && onChange(visible);
      }
      function show() {
        setState(true);
      }
      function hide() {
        setState(false);
      }
      function handleKeyup(e) {
        // Char Code: 27  ESC
        if (e.which ===  27) {
          hide();
        }
      }
      setOptions(options);
      init();
      return {
        show: show,
        hide: hide,
        $el: $root
      };
    }
    $.fn.modal = modal;
  });
})();
</script><div class="modal modal--overflow page__search-modal d-print-none js-page-search-modal"><script>
(function () {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    // search panel
    var search = (window.search || (window.search = {}));
    var useDefaultSearchBox = window.useDefaultSearchBox === undefined ?
      true : window.useDefaultSearchBox ;

    var $searchModal = $('.js-page-search-modal');
    var $searchToggle = $('.js-search-toggle');
    var searchModal = $searchModal.modal({ onChange: handleModalChange, hideWhenWindowScroll: true });
    var modalVisible = false;
    search.searchModal = searchModal;

    var $searchBox = null;
    var $searchInput = null;
    var $searchClear = null;

    function getModalVisible() {
      return modalVisible;
    }
    search.getModalVisible = getModalVisible;

    function handleModalChange(visible) {
      modalVisible = visible;
      if (visible) {
        search.onShow && search.onShow();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].focus();
      } else {
        search.onShow && search.onHide();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].blur();
        setTimeout(function() {
          useDefaultSearchBox && ($searchInput.val(''), $searchBox.removeClass('not-empty'));
          search.clear && search.clear();
          window.pageAsideAffix && window.pageAsideAffix.refresh();
        }, 400);
      }
    }

    $searchToggle.on('click', function() {
      modalVisible ? searchModal.hide() : searchModal.show();
    });
    // Char Code: 83  S, 191 /
    $(window).on('keyup', function(e) {
      if (!modalVisible && !window.isFormElement(e.target || e.srcElement) && (e.which === 83 || e.which === 191)) {
        modalVisible || searchModal.show();
      }
    });

    if (useDefaultSearchBox) {
      $searchBox = $('.js-search-box');
      $searchInput = $searchBox.children('input');
      $searchClear = $searchBox.children('.js-icon-clear');
      search.getSearchInput = function() {
        return $searchInput.get(0);
      };
      search.getVal = function() {
        return $searchInput.val();
      };
      search.setVal = function(val) {
        $searchInput.val(val);
      };

      $searchInput.on('focus', function() {
        $(this).addClass('focus');
      });
      $searchInput.on('blur', function() {
        $(this).removeClass('focus');
      });
      $searchInput.on('input', window.throttle(function() {
        var val = $(this).val();
        if (val === '' || typeof val !== 'string') {
          search.clear && search.clear();
        } else {
          $searchBox.addClass('not-empty');
          search.onInputNotEmpty && search.onInputNotEmpty(val);
        }
      }, 400));
      $searchClear.on('click', function() {
        $searchInput.val(''); $searchBox.removeClass('not-empty');
        search.clear && search.clear();
      });
    }
  });
})();
</script><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--theme-dark button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>
<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var search = (window.search || (window.search = {}));
  var searchData = window.TEXT_SEARCH_DATA || {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) { return null; }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function clear() {
    $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }
  function onInputNotEmpty(val) {
    $result.html(render(searchByQuery(val)));
    $resultItems = $('.search-result__item'); activeIndex = 0;
    $resultItems.eq(0).addClass('active');
  }

  search.clear = clear;
  search.onInputNotEmpty = onInputNotEmpty;

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  // Char Code: 13  Enter, 37  ⬅, 38  ⬆, 39  ➡, 40  ⬇
  $(window).on('keyup', function(e) {
    var modalVisible = search.getModalVisible && search.getModalVisible();
    if (modalVisible) {
      if (e.which === 38) {
        modalVisible && moveActiveIndex('up');
      } else if (e.which === 40) {
        modalVisible && moveActiveIndex('down');
      } else if (e.which === 13) {
        modalVisible && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });
});
</script>
</div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true, { animation: false }); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc toc--ellipsis"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();
/*(function () {

})();*/
</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();
</script><script>
  window.Lazyload.js(['https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js', 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js'], function() {
    var $canvas = null, $this = null, _ctx = null, _text = '';
    $('.language-chart').each(function(){
      $this = $(this);
      $canvas = $('<canvas></canvas>');
      _text = $this.text();
      $this.text('').append($canvas);
      _ctx = $canvas.get(0).getContext('2d');
      (_ctx && _text) && (new Chart(_ctx, JSON.parse(_text)) && $this.attr('data-processed', true));
    });
  });
</script>
<script type="text/x-mathjax-config">
	var _config = { tex2jax: {
		inlineMath: [['$','$'], ['\\(','\\)']]
	}};MathJax.Hub.Config(_config);
</script>
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<script>
  window.Lazyload.js('https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js', function() {
    mermaid.initialize({
      startOnLoad: true
    });
    mermaid.init(undefined, '.language-mermaid');
  });
</script>

    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();
</script>
  </body>
</html>

